/*!
 * HTML5 export buttons for Buttons and DataTables.
 * 2016 SpryMedia Ltd - datatables.net/license
 *
 * FileSaver.js (1.1.20160328) - MIT license
 * Copyright © 2016 Eli Grey - http://eligrey.com
 */
(function(a){if(typeof define==="function"&&define.amd){define(["jquery","datatables.net","datatables.net-buttons"],function(b){return a(b,window,document)})}else{if(typeof exports==="object"){module.exports=function(b,d,e,c){if(!b){b=window}if(!d||!d.fn.dataTable){d=require("datatables.net")(b,d).$}if(!d.fn.dataTable.Buttons){require("datatables.net-buttons")(b,d)}return a(d,b,b.document,e,c)}}else{a(jQuery,window,document)}}}(function(c,l,v,k,b,f){var s=c.fn.dataTable;function e(){return k||l.JSZip}function w(){return b||l.pdfMake}var p=(function(G){if(typeof navigator!=="undefined"&&/MSIE [1-9]\./.test(navigator.userAgent)){return}var R=G.document,L=function(){return G.URL||G.webkitURL||G},N=R.createElementNS("http://www.w3.org/1999/xhtml","a"),E="download" in N,J=function(T){var S=new MouseEvent("click");T.dispatchEvent(S)},A=/Version\/[\d\.]+.*Safari/.test(navigator.userAgent),O=G.webkitRequestFileSystem,P=G.requestFileSystem||O||G.mozRequestFileSystem,M=function(S){(G.setImmediate||G.setTimeout)(function(){throw S},0)},B="application/octet-stream",K=0,H=1000*40,I=function(T){var S=function(){if(typeof T==="string"){L().revokeObjectURL(T)}else{T.remove()}};setTimeout(S,H)},Q=function(T,S,W){S=[].concat(S);var V=S.length;while(V--){var X=T["on"+S[V]];if(typeof X==="function"){try{X.call(T,W||T)}catch(U){M(U)}}}},F=function(S){if(/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(S.type)){return new Blob(["\ufeff",S],{type:S.type})}return S},D=function(S,T,U){if(!U){S=F(S)}var V=this,ab=S.type,ae=false,X,W,aa=function(){Q(V,"writestart progress write writeend".split(" "))},ad=function(){if(W&&A&&typeof FileReader!=="undefined"){var af=new FileReader();af.onloadend=function(){var ah=af.result;W.location.href="data:attachment/file"+ah.slice(ah.search(/[,;]/));V.readyState=V.DONE;aa()};af.readAsDataURL(S);V.readyState=V.INIT;return}if(ae||!X){X=L().createObjectURL(S)}if(W){W.location.href=X}else{var ag=G.open(X,"_blank");if(ag===f&&A){G.location.href=X}}V.readyState=V.DONE;aa();I(X)},Z=function(af){return function(){if(V.readyState!==V.DONE){return af.apply(this,arguments)}}},Y={create:true,exclusive:false},ac;V.readyState=V.INIT;if(!T){T="download"}if(E){X=L().createObjectURL(S);setTimeout(function(){N.href=X;N.download=T;J(N);aa();I(X);V.readyState=V.DONE});return}if(G.chrome&&ab&&ab!==B){ac=S.slice||S.webkitSlice;S=ac.call(S,0,S.size,B);ae=true}if(O&&T!=="download"){T+=".download"}if(ab===B||O){W=G}if(!P){ad();return}K+=S.size;P(G.TEMPORARY,K,Z(function(af){af.root.getDirectory("saved",Y,Z(function(ag){var ah=function(){ag.getFile(T,Y,Z(function(ai){ai.createWriter(Z(function(aj){aj.onwriteend=function(ak){W.location.href=ai.toURL();V.readyState=V.DONE;Q(V,"writeend",ak);I(ai)};aj.onerror=function(){var ak=aj.error;if(ak.code!==ak.ABORT_ERR){ad()}};"writestart progress write abort".split(" ").forEach(function(ak){aj["on"+ak]=V["on"+ak]});aj.write(S);V.abort=function(){aj.abort();V.readyState=V.DONE};V.readyState=V.WRITING}),ad)}),ad)};ag.getFile(T,{create:false},Z(function(ai){ai.remove();ah()}),Z(function(ai){if(ai.code===ai.NOT_FOUND_ERR){ah()}else{ad()}}))}),ad)}),ad)},C=D.prototype,t=function(T,U,S){return new D(T,U,S)};if(typeof navigator!=="undefined"&&navigator.msSaveOrOpenBlob){return function(T,U,S){if(!S){T=F(T)}return navigator.msSaveOrOpenBlob(T,U||"download")}}C.abort=function(){var S=this;S.readyState=S.DONE;Q(S,"abort")};C.readyState=C.INIT=0;C.WRITING=1;C.DONE=2;C.error=C.onwritestart=C.onprogress=C.onwrite=C.onabort=C.onerror=C.onwriteend=null;return t}(typeof self!=="undefined"&&self||typeof l!=="undefined"&&l||this.content));s.fileSave=p;var y=function(A,B){var t=A.filename==="*"&&A.title!=="*"&&A.title!==f?A.title:A.filename;if(typeof t==="function"){t=t()}if(t.indexOf("*")!==-1){t=c.trim(t.replace("*",c("title").text()))}t=t.replace(/[^a-zA-Z0-9_\u00A1-\uFFFF\.,\-_ !\(\)]/g,"");return B===f||B===true?t+A.extension:t};var o=function(t){var A="Sheet1";if(t.sheetName){A=t.sheetName.replace(/[\[\]\*\/\\\?\:]/g,"")}return A};var r=function(t){var A=t.title;if(typeof A==="function"){A=A()}return A.indexOf("*")!==-1?A.replace("*",c("title").text()||"Exported data"):A};var j=function(t){return t.newline?t.newline:navigator.userAgent.match(/Windows/)?"\r\n":"\n"};var z=function(B,C){var J=j(C);var F=B.buttons.exportData(C.exportOptions);var A=C.fieldBoundary;var H=C.fieldSeparator;var D=new RegExp(A,"g");var M=C.escapeChar!==f?C.escapeChar:"\\";var t=function(O){var Q="";for(var P=0,N=O.length;P<N;P++){if(P>0){Q+=H}Q+=A?A+(""+O[P]).replace(D,M+A)+A:O[P]}return Q};var G=C.header?t(F.header)+J:"";var K=C.footer&&F.footer?J+t(F.footer):"";var I=[];for(var E=0,L=F.body.length;E<L;E++){I.push(t(F.body[E]))}return{str:G+I.join(J)+K,rows:I.length}};var a=function(){return navigator.userAgent.indexOf("Safari")!==-1&&navigator.userAgent.indexOf("Chrome")===-1&&navigator.userAgent.indexOf("Opera")===-1};function h(D){var C="A".charCodeAt(0);var A="Z".charCodeAt(0);var t=A-C+1;var B="";while(D>=0){B=String.fromCharCode(D%t+C)+B;D=Math.floor(D/t)-1}return B}try{var g=new XMLSerializer();var x}catch(q){}function m(t,A){if(x===f){x=g.serializeToString(c.parseXML(u["xl/worksheets/sheet1.xml"])).indexOf("xmlns:r")===-1}c.each(A,function(B,C){if(c.isPlainObject(C)){var D=t.folder(B);m(D,C)}else{if(x){var J=C.childNodes[0];var E,L;var K=[];for(E=J.attributes.length-1;E>=0;E--){var I=J.attributes[E].nodeName;var F=J.attributes[E].nodeValue;if(I.indexOf(":")!==-1){K.push({name:I,value:F});J.removeAttribute(I)}}for(E=0,L=K.length;E<L;E++){var G=C.createAttribute(K[E].name.replace(":","_dt_b_namespace_token_"));G.value=K[E].value;J.setAttributeNode(G)}}var H=g.serializeToString(C);if(x){if(H.indexOf("<?xml")===-1){H='<?xml version="1.0" encoding="UTF-8" standalone="yes"?>'+H}H=H.replace(/_dt_b_namespace_token_/g,":")}H=H.replace(/<row xmlns="" /g,"<row ").replace(/<cols xmlns="">/g,"<cols>");t.file(B,H)}})}function i(B,C,t){var A=B.createElement(C);if(t){if(t.attr){c(A).attr(t.attr)}if(t.children){c.each(t.children,function(D,E){A.appendChild(E)})}if(t.text){A.appendChild(B.createTextNode(t.text))}}return A}function n(E,C){var A=E.header[C].length;var t,G,F;if(E.footer&&E.footer[C].length>A){A=E.footer[C].length}for(var D=0,B=E.body.length;D<B;D++){F=E.body[D][C].toString();if(F.indexOf("\n")!==-1){G=F.split("\n");G.sort(function(I,H){return H.length-I.length});t=G[0].length}else{t=F.length}if(t>A){A=t}if(A>40){break}}A*=1.3;return A>6?A:6}var u={"_rels/.rels":'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships"><Relationship Id="rId1" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument" Target="xl/workbook.xml"/></Relationships>',"xl/_rels/workbook.xml.rels":'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships"><Relationship Id="rId1" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet" Target="worksheets/sheet1.xml"/><Relationship Id="rId2" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles" Target="styles.xml"/></Relationships>',"[Content_Types].xml":'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><Types xmlns="http://schemas.openxmlformats.org/package/2006/content-types"><Default Extension="xml" ContentType="application/xml" /><Default Extension="rels" ContentType="application/vnd.openxmlformats-package.relationships+xml" /><Default Extension="jpeg" ContentType="image/jpeg" /><Override PartName="/xl/workbook.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml" /><Override PartName="/xl/worksheets/sheet1.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml" /><Override PartName="/xl/styles.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml" /></Types>',"xl/workbook.xml":'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><workbook xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships"><fileVersion appName="xl" lastEdited="5" lowestEdited="5" rupBuild="24816"/><workbookPr showInkAnnotation="0" autoCompressPictures="0"/><bookViews><workbookView xWindow="0" yWindow="0" windowWidth="25600" windowHeight="19020" tabRatio="500"/></bookViews><sheets><sheet name="" sheetId="1" r:id="rId1"/></sheets></workbook>',"xl/worksheets/sheet1.xml":'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><worksheet xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships" xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" mc:Ignorable="x14ac" xmlns:x14ac="http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac"><sheetData/></worksheet>',"xl/styles.xml":'<?xml version="1.0" encoding="UTF-8"?><styleSheet xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" mc:Ignorable="x14ac" xmlns:x14ac="http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac"><numFmts count="4"><numFmt numFmtId="164" formatCode="#,##0.00_- [$$-45C]"/><numFmt numFmtId="165" formatCode="&quot;£&quot;#,##0.00"/><numFmt numFmtId="166" formatCode="[$€-2] #,##0.00"/><numFmt numFmtId="167" formatCode="0.0%"/></numFmts><fonts count="5" x14ac:knownFonts="1"><font><sz val="11" /><name val="Calibri" /></font><font><sz val="11" /><name val="Calibri" /><color rgb="FFFFFFFF" /></font><font><sz val="11" /><name val="Calibri" /><b /></font><font><sz val="11" /><name val="Calibri" /><i /></font><font><sz val="11" /><name val="Calibri" /><u /></font></fonts><fills count="6"><fill><patternFill patternType="none" /></fill><fill/><fill><patternFill patternType="solid"><fgColor rgb="FFD9D9D9" /><bgColor indexed="64" /></patternFill></fill><fill><patternFill patternType="solid"><fgColor rgb="FFD99795" /><bgColor indexed="64" /></patternFill></fill><fill><patternFill patternType="solid"><fgColor rgb="ffc6efce" /><bgColor indexed="64" /></patternFill></fill><fill><patternFill patternType="solid"><fgColor rgb="ffc6cfef" /><bgColor indexed="64" /></patternFill></fill></fills><borders count="2"><border><left /><right /><top /><bottom /><diagonal /></border><border diagonalUp="false" diagonalDown="false"><left style="thin"><color auto="1" /></left><right style="thin"><color auto="1" /></right><top style="thin"><color auto="1" /></top><bottom style="thin"><color auto="1" /></bottom><diagonal /></border></borders><cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0" /></cellStyleXfs><cellXfs count="61"><xf numFmtId="0" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="1" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="2" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="3" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="4" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="0" fillId="2" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="1" fillId="2" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="2" fillId="2" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="3" fillId="2" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="4" fillId="2" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="0" fillId="4" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="1" fillId="4" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="2" fillId="4" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="3" fillId="4" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="4" fillId="4" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="0" fillId="4" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="1" fillId="4" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="2" fillId="4" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="3" fillId="4" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="4" fillId="4" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="0" fillId="5" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="1" fillId="5" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="2" fillId="5" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="3" fillId="5" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="4" fillId="5" borderId="0" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="0" fillId="0" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="1" fillId="0" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="2" fillId="0" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="3" fillId="0" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="4" fillId="0" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="0" fillId="2" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="1" fillId="2" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="2" fillId="2" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="3" fillId="2" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="4" fillId="2" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="0" fillId="3" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="1" fillId="3" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="2" fillId="3" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="3" fillId="3" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="4" fillId="3" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="0" fillId="4" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="1" fillId="4" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="2" fillId="4" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="3" fillId="4" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="4" fillId="4" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="0" fillId="5" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="1" fillId="5" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="2" fillId="5" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="3" fillId="5" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="4" fillId="5" borderId="1" applyFont="1" applyFill="1" applyBorder="1"/><xf numFmtId="0" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyAlignment="1"><alignment horizontal="left"/></xf><xf numFmtId="0" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyAlignment="1"><alignment horizontal="center"/></xf><xf numFmtId="0" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyAlignment="1"><alignment horizontal="right"/></xf><xf numFmtId="0" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyAlignment="1"><alignment horizontal="fill"/></xf><xf numFmtId="0" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyAlignment="1"><alignment textRotation="90"/></xf><xf numFmtId="0" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyAlignment="1"><alignment wrapText="1"/></xf><xf numFmtId="9"   fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyNumberFormat="1"/><xf numFmtId="164" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyNumberFormat="1"/><xf numFmtId="165" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyNumberFormat="1"/><xf numFmtId="166" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyNumberFormat="1"/><xf numFmtId="167" fontId="0" fillId="0" borderId="0" applyFont="1" applyFill="1" applyBorder="1" xfId="0" applyNumberFormat="1"/></cellXfs><cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0" /></cellStyles><dxfs count="0" /><tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4" /></styleSheet>'};var d=[{match:/^\d+\.\d%$/,style:60,fmt:function(t){return t/100}},{match:/^\d+\.?\d*%$/,style:56,fmt:function(t){return t/100}},{match:/^\$[\d,]+.?\d*$/,style:57},{match:/^£[\d,]+.?\d*$/,style:58},{match:/^€[\d,]+.?\d*$/,style:59}];s.ext.buttons.copyHtml5={className:"buttons-copy buttons-html5",text:function(t){return t.i18n("buttons.copy","Copy")},action:function(H,B,F,C){var E=z(B,C);var D=E.str;var I=c("<div/>").css({height:1,width:1,overflow:"hidden",position:"fixed",top:0,left:0});if(C.customize){D=C.customize(D,C)}var J=c("<textarea readonly/>").val(D).appendTo(I);if(v.queryCommandSupported("copy")){I.appendTo(B.table().container());J[0].focus();J[0].select();try{var G=v.execCommand("copy");I.remove();if(G){B.buttons.info(B.i18n("buttons.copyTitle","Copy to clipboard"),B.i18n("buttons.copySuccess",{1:"Copied one row to clipboard",_:"Copied %d rows to clipboard"},E.rows),2000);return}}catch(L){}}var M=c("<span>"+B.i18n("buttons.copyKeys","Press <i>ctrl</i> or <i>\u2318</i> + <i>C</i> to copy the table data<br>to your system clipboard.<br><br>To cancel, click this message or press escape.")+"</span>").append(I);B.buttons.info(B.i18n("buttons.copyTitle","Copy to clipboard"),M,0);J[0].focus();J[0].select();var A=c(M).closest(".dt-button-info");var K=function(){A.off("click.buttons-copy");c(v).off(".buttons-copy");B.buttons.info(false)};A.on("click.buttons-copy",K);c(v).on("keydown.buttons-copy",function(t){if(t.keyCode===27){K()}}).on("copy.buttons-copy cut.buttons-copy",function(){K()})},exportOptions:{},fieldSeparator:"\t",fieldBoundary:"",header:true,footer:false};s.ext.buttons.csvHtml5={bom:false,className:"buttons-csv buttons-html5",available:function(){return l.FileReader!==f&&l.Blob},text:function(t){return t.i18n("buttons.csv","CSV")},action:function(D,C,B,A){var t=z(C,A).str;var E=A.charset;if(A.customize){t=A.customize(t,A)}if(E!==false){if(!E){E=v.characterSet||v.charset}if(E){E=";charset="+E}}else{E=""}if(A.bom){t="\ufeff"+t}p(new Blob([t],{type:"text/csv"+E}),y(A),true)},filename:"*",extension:".csv",exportOptions:{},fieldSeparator:",",fieldBoundary:'"',escapeChar:'"',charset:null,header:true,footer:false};s.ext.buttons.excelHtml5={className:"buttons-excel buttons-html5",available:function(){return l.FileReader!==f&&e()!==f&&!a()&&g},text:function(t){return t.i18n("buttons.excel","Excel")},action:function(Q,J,t,R){var O=0;var M=function(U){var V=u[U];return c.parseXML(V)};var D=M("xl/worksheets/sheet1.xml");var H=D.getElementsByTagName("sheetData")[0];var E={_rels:{".rels":M("_rels/.rels")},xl:{_rels:{"workbook.xml.rels":M("xl/_rels/workbook.xml.rels")},"workbook.xml":M("xl/workbook.xml"),"styles.xml":M("xl/styles.xml"),worksheets:{"sheet1.xml":D}},"[Content_Types].xml":M("[Content_Types].xml")};var T=J.buttons.exportData(R.exportOptions);var S,B;var A=function(ad){S=O+1;B=i(D,"row",{attr:{r:S}});for(var Y=0,ac=ad.length;Y<ac;Y++){var V=h(Y)+""+S;var aa=null;if(ad[Y]===null||ad[Y]===f||ad[Y]==""){continue}ad[Y]=c.trim(ad[Y]);for(var X=0,U=d.length;X<U;X++){var Z=d[X];if(ad[Y].match&&ad[Y].match(Z.match)){var W=ad[Y].replace(/[^\d\.\-]/g,"");if(Z.fmt){W=Z.fmt(W)}aa=i(D,"c",{attr:{r:V,s:Z.style},children:[i(D,"v",{text:W})]});break}}if(!aa){if(typeof ad[Y]==="number"||(ad[Y].match&&ad[Y].match(/^-?\d+(\.\d+)?$/)&&!ad[Y].match(/^0\d+/))){aa=i(D,"c",{attr:{t:"n",r:V},children:[i(D,"v",{text:ad[Y]})]})}else{var ab=!ad[Y].replace?ad[Y]:ad[Y].replace(/[\x00-\x09\x0B\x0C\x0E-\x1F\x7F-\x9F]/g,"");aa=i(D,"c",{attr:{t:"inlineStr",r:V},children:{row:i(D,"is",{children:{row:i(D,"t",{text:ab})}})}})}}B.appendChild(aa)}H.appendChild(B);O++};c("sheets sheet",E.xl["workbook.xml"]).attr("name",o(R));if(R.customizeData){R.customizeData(T)}if(R.header){A(T.header,O);c("row c",D).attr("s","2")}for(var L=0,K=T.body.length;L<K;L++){A(T.body[L],O)}if(R.footer&&T.footer){A(T.footer,O);c("row:last c",D).attr("s","2")}var I=i(D,"cols");c("worksheet",D).prepend(I);for(var N=0,C=T.header.length;N<C;N++){I.appendChild(i(D,"col",{attr:{min:N+1,max:N+1,width:n(T,N),customWidth:1}}))}if(R.customize){R.customize(E)}var G=e();var P=new G();var F={type:"blob",mimeType:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"};m(P,E);if(P.generateAsync){P.generateAsync(F).then(function(U){p(U,y(R))})}else{p(P.generate(F),y(R))}},filename:"*",extension:".xlsx",exportOptions:{},header:true,footer:false};s.ext.buttons.pdfHtml5={className:"buttons-pdf buttons-html5",available:function(){return l.FileReader!==f&&w()},text:function(t){return t.i18n("buttons.pdf","PDF")},action:function(G,A,E,B){var F=j(B);var C=A.buttons.exportData(B.exportOptions);var J=[];if(B.header){J.push(c.map(C.header,function(K){return{text:typeof K==="string"?K:K+"",style:"tableHeader"}}))}for(var D=0,I=C.body.length;D<I;D++){J.push(c.map(C.body[D],function(K){return{text:typeof K==="string"?K:K+"",style:D%2?"tableBodyEven":"tableBodyOdd"}}))}if(B.footer&&C.footer){J.push(c.map(C.footer,function(K){return{text:typeof K==="string"?K:K+"",style:"tableFooter"}}))}var H={pageSize:B.pageSize,pageOrientation:B.orientation,content:[{table:{headerRows:1,body:J},layout:"noBorders"}],styles:{tableHeader:{bold:true,fontSize:11,color:"white",fillColor:"#2d4154",alignment:"center"},tableBodyEven:{},tableBodyOdd:{fillColor:"#f3f3f3"},tableFooter:{bold:true,fontSize:11,color:"white",fillColor:"#2d4154"},title:{alignment:"center",fontSize:15},message:{}},defaultStyle:{fontSize:10}};if(B.message){H.content.unshift({text:typeof B.message=="function"?B.message(A,E,B):B.message,style:"message",margin:[0,0,0,12]})}if(B.title){H.content.unshift({text:r(B,false),style:"title",margin:[0,0,0,12]})}if(B.customize){B.customize(H,B)}var t=w().createPdf(H);if(B.download==="open"&&!a()){t.open()}else{t.getBuffer(function(K){var L=new Blob([K],{type:"application/pdf"});p(L,y(B))})}},title:"*",filename:"*",extension:".pdf",exportOptions:{},orientation:"portrait",pageSize:"A4",header:true,footer:false,message:null,customize:null,download:"download"};return s.Buttons}));