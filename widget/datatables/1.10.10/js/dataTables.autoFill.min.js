/*! AutoFill 2.1.3-dev
 * Â©2008-2015 SpryMedia Ltd - datatables.net/license
 */
(function(a){if(typeof define==="function"&&define.amd){define(["jquery","datatables.net"],function(b){return a(b,window,document)})}else{if(typeof exports==="object"){module.exports=function(b,c){if(!b){b=window}if(!c||!c.fn.dataTable){c=require("datatables.net")(b,c).$}return a(c,b,b.document)}}else{a(jQuery,window,document)}}}(function(f,d,a,g){var e=f.fn.dataTable;var b=0;var c=function(i,h){if(!e.versionCheck||!e.versionCheck("1.10.8")){throw ("Warning: AutoFill requires DataTables 1.10.8 or greater")}this.c=f.extend(true,{},e.defaults.autoFill,c.defaults,h);this.s={dt:new e.Api(i),namespace:".autoFill"+(b++),scroll:{},scrollInterval:null,handle:{height:0,width:0}};this.dom={handle:f('<div class="dt-autofill-handle"/>'),select:{top:f('<div class="dt-autofill-select top"/>'),right:f('<div class="dt-autofill-select right"/>'),bottom:f('<div class="dt-autofill-select bottom"/>'),left:f('<div class="dt-autofill-select left"/>')},background:f('<div class="dt-autofill-background"/>'),list:f('<div class="dt-autofill-list">'+this.s.dt.i18n("autoFill.info","")+"<ul/></div>"),dtScroll:null,offsetParent:null};this._constructor()};f.extend(c.prototype,{_constructor:function(){var j=this;var i=this.s.dt;var h=f("div.dataTables_scrollBody",this.s.dt.table().container());if(h.length){this.dom.dtScroll=h;if(h.css("position")==="static"){h.css("position","relative")}}this._focusListener();this.dom.handle.on("mousedown",function(k){j._mousedown(k);return false});i.on("destroy.autoFill",function(){i.off(".autoFill");f(i.table().body()).off(j.s.namespace);f(a.body).off(j.s.namespace)})},_attach:function(k){var j=this.s.dt;var h=j.cell(k).index();var l=this.dom.handle;var i=this.s.handle;if(!h||j.columns(this.c.columns).indexes().indexOf(h.column)===-1){this._detach();return}if(!this.dom.offsetParent){this.dom.offsetParent=f(j.table().node()).offsetParent()}if(!i.height||!i.width){l.appendTo("body");i.height=l.outerHeight();i.width=l.outerWidth()}var m=this._getPosition(k,this.dom.offsetParent);this.dom.attachedTo=k;l.css({top:m.top+k.offsetHeight-i.height,left:m.left+k.offsetWidth-i.width}).appendTo(this.dom.offsetParent)},_actionSelector:function(i){var k=this;var j=this.s.dt;var n=c.actions;var m=[];f.each(n,function(o,p){if(p.available(j,i)){m.push(o)}});if(m.length===1&&this.c.alwaysAsk===false){var h=n[m[0]].execute(j,i);this._update(h,i)}else{var l=this.dom.list.children("ul").empty();m.push("cancel");f.each(m,function(p,o){l.append(f("<li/>").append('<div class="dt-autofill-question">'+n[o].option(j,i)+"<div>").append(f('<div class="dt-autofill-button">').append(f('<button class="'+c.classes.btn+'">'+j.i18n("autoFill.button","&gt;")+"</button>").on("click",function(){var q=n[o].execute(j,i,f(this).closest("li"));k._update(q,i);k.dom.background.remove();k.dom.list.remove()}))))});this.dom.background.appendTo("body");this.dom.list.appendTo("body");this.dom.list.css("margin-top",this.dom.list.outerHeight()/2*-1)}},_detach:function(){this.dom.attachedTo=null;this.dom.handle.detach()},_drawSelection:function(o,p){var l=this.s.dt;var j=this.s.start;var s=f(this.dom.start);var k=f(o);var n={row:l.rows({page:"current"}).nodes().indexOf(k.parent()[0]),column:k.index()};if(!l.cell(k).any()){return}if(l.columns(this.c.columns).indexes().indexOf(n.column)===-1){return}this.s.end=n;var q,h,m,t,u,i;q=j.row<n.row?s:k;h=j.row<n.row?k:s;m=j.column<n.column?s:k;t=j.column<n.column?k:s;q=this._getPosition(q).top;m=this._getPosition(m).left;u=this._getPosition(h).top+h.outerHeight()-q;i=this._getPosition(t).left+t.outerWidth()-m;var r=this.dom.select;r.top.css({top:q,left:m,width:i});r.left.css({top:q,left:m,height:u});r.bottom.css({top:q+u,left:m,width:i});r.right.css({top:q,left:m+i,height:u})},_editor:function(o){var u=this.s.dt;var p=this.c.editor;if(!p){return}var t={};var x=[];var w=p.fields();for(var B=0,m=o.length;B<m;B++){for(var A=0,y=o[B].length;A<y;A++){var h=o[B][A];var r=u.settings()[0].aoColumns[h.index.column];var n=r.editField;if(n===g){var s=r.mData;for(var z=0,q=w.length;z<q;z++){var l=p.field(w[z]);if(l.dataSrc()===s){n=l.name();break}}}if(!n){throw"Could not automatically determine field data. Please see https://datatables.net/tn/11"}if(!t[n]){t[n]={}}var v=u.row(h.index.row).id();t[n][v]=h.set;x.push(h.index)}}p.bubble(x,false).multiSet(t).submit()},_emitEvent:function(i,h){this.s.dt.iterator("table",function(j,k){f(j.nTable).triggerHandler(i+".dt",h)})},_focusListener:function(){var k=this;var j=this.s.dt;var i=this.s.namespace;var h=this.c.focus!==null?this.c.focus:j.init().keys||j.settings()[0].keytable?"focus":"hover";if(h==="focus"){j.on("key-focus.autoFill",function(n,m,l){k._attach(l.node())}).on("key-blur.autoFill",function(n,m,l){k._detach()})}else{if(h==="click"){f(j.table().body()).on("click"+i,"td, th",function(l){k._attach(this)});f(a.body).on("click"+i,function(l){if(!f(l.target).parents().filter(j.table().body()).length){k._detach()}})}else{f(j.table().body()).on("mouseenter"+i,"td, th",function(l){k._attach(this)}).on("mouseleave"+i,function(l){if(f(l.relatedTarget).hasClass("dt-autofill-handle")){return}k._detach()})}}},_getPosition:function(k,j){var i=f(k),n,h,m=0,l=0;if(!j){j=f(this.s.dt.table().node()).offsetParent()}do{h=i.position();n=i.offsetParent();m+=h.top+n.scrollTop();l+=h.left+n.scrollLeft();if(i.get(0).nodeName.toLowerCase()==="body"){break}i=n}while(n.get(0)!==j.get(0));return{top:m,left:l}},_mousedown:function(m){var l=this;var k=this.s.dt;this.dom.start=this.dom.attachedTo;this.s.start={row:k.rows({page:"current"}).nodes().indexOf(f(this.dom.start).parent()[0]),column:f(this.dom.start).index()};f(a.body).on("mousemove.autoFill",function(n){l._mousemove(n)}).on("mouseup.autoFill",function(n){l._mouseup(n)});var h=this.dom.select;var j=f(k.table().node()).offsetParent();h.top.appendTo(j);h.left.appendTo(j);h.right.appendTo(j);h.bottom.appendTo(j);this._drawSelection(this.dom.start,m);this.dom.handle.css("display","none");var i=this.dom.dtScroll;this.s.scroll={windowHeight:f(d).height(),windowWidth:f(d).width(),dtTop:i?i.offset().top:null,dtLeft:i?i.offset().left:null,dtHeight:i?i.outerHeight():null,dtWidth:i?i.outerWidth():null}},_mousemove:function(k){var j=this;var i=this.s.dt;var h=k.target.nodeName.toLowerCase();if(h!=="td"&&h!=="th"){return}this._drawSelection(k.target,k);this._shiftScroll(k)},_mouseup:function(p){f(a.body).off(".autoFill");var j=this.s.dt;var q=this.dom.select;q.top.remove();q.left.remove();q.right.remove();q.bottom.remove();this.dom.handle.css("display","block");var i=this.s.start;var m=this.s.end;if(i.row===m.row&&i.column===m.column){return}var r=this._range(i.row,m.row);var l=this._range(i.column,m.column);var n=[];var k=j.settings()[0];var o=k.aoColumns;for(var h=0;h<r.length;h++){n.push(f.map(l,function(v){var s=j.cell(":eq("+r[h]+")",v+":visible",{page:"current"});var w=s.data();var u=s.index();var t=o[u.column].editField;if(t!==g){w=k.oApi._fnGetObjectDataFn(t)(j.row(u.row).data())}return{cell:s,data:w,label:s.data(),index:u}}))}this._actionSelector(n);clearInterval(this.s.scrollInterval);this.s.scrollInterval=null},_range:function(l,h){var j=[];var k;if(l<=h){for(k=l;k<=h;k++){j.push(k)}}else{for(k=l;k>=h;k--){j.push(k)}}return j},_shiftScroll:function(n){var m=this;var h=this.s.dt;var q=this.s.scroll;var p=false;var o=5;var j=65;var r=n.pageY-a.body.scrollTop,t=n.pageX-a.body.scrollLeft,i,s,k,l;if(r<j){i=o*-1}else{if(r>q.windowHeight-j){i=o}}if(t<j){s=o*-1}else{if(t>q.windowWidth-j){s=o}}if(q.dtTop!==null&&n.pageY<q.dtTop+j){k=o*-1}else{if(q.dtTop!==null&&n.pageY>q.dtTop+q.dtHeight-j){k=o}}if(q.dtLeft!==null&&n.pageX<q.dtLeft+j){l=o*-1}else{if(q.dtLeft!==null&&n.pageX>q.dtLeft+q.dtWidth-j){l=o}}if(i||s||k||l){q.windowVert=i;q.windowHoriz=s;q.dtVert=k;q.dtHoriz=l;p=true}else{if(this.s.scrollInterval){clearInterval(this.s.scrollInterval);this.s.scrollInterval=null}}if(!this.s.scrollInterval&&p){this.s.scrollInterval=setInterval(function(){if(q.windowVert){a.body.scrollTop+=q.windowVert}if(q.windowHoriz){a.body.scrollLeft+=q.windowHoriz}if(q.dtVert||q.dtHoriz){var u=m.dom.dtScroll[0];if(q.dtVert){u.scrollTop+=q.dtVert}if(q.dtHoriz){u.scrollLeft+=q.dtHoriz}}},20)}},_update:function(r,q){if(r===false){return}var k=this.s.dt;var o;this._emitEvent("preAutoFill",[k,q]);this._editor(q);var l=this.c.update!==null?this.c.update:this.c.editor?false:true;if(l){for(var n=0,p=q.length;n<p;n++){for(var m=0,h=q[n].length;m<h;m++){o=q[n][m];o.cell.data(o.set)}}k.draw(false)}this._emitEvent("autoFill",[k,q])}});c.actions={increment:{available:function(i,h){return f.isNumeric(h[0][0].label)},option:function(i,h){return i.i18n("autoFill.increment",'Increment / decrement each cell by: <input type="number" value="1">')},execute:function(k,r,l){var o=r[0][0].data*1;var p=f("input",l).val()*1;for(var n=0,q=r.length;n<q;n++){for(var m=0,h=r[n].length;m<h;m++){r[n][m].set=o;o+=p}}}},fill:{available:function(i,h){return true},option:function(i,h){return i.i18n("autoFill.fill","Fill all cells with <i>"+h[0][0].label+"</i>")},execute:function(o,l,n){var p=l[0][0].data;for(var m=0,h=l.length;m<h;m++){for(var k=0,q=l[m].length;k<q;k++){l[m][k].set=p}}}},fillHorizontal:{available:function(i,h){return h.length>1&&h[0].length>1},option:function(i,h){return i.i18n("autoFill.fillHorizontal","Fill cells horizontally")},execute:function(o,l,n){for(var m=0,h=l.length;m<h;m++){for(var k=0,p=l[m].length;k<p;k++){l[m][k].set=l[m][0].data}}}},fillVertical:{available:function(i,h){return h.length>1&&h[0].length>1},option:function(i,h){return i.i18n("autoFill.fillVertical","Fill cells vertically")},execute:function(o,l,n){for(var m=0,h=l.length;m<h;m++){for(var k=0,p=l[m].length;k<p;k++){l[m][k].set=l[0][k].data}}}},cancel:{available:function(){return false},option:function(h){return h.i18n("autoFill.cancel","Cancel")},execute:function(){return false}}};c.version="2.1.3-dev";c.defaults={alwaysAsk:false,focus:null,columns:"",update:null,editor:null};c.classes={btn:"btn"};f(a).on("preInit.dt.autofill",function(l,i,h){if(l.namespace!=="dt"){return}var m=i.oInit.autoFill;var k=e.defaults.autoFill;if(m||k){var j=f.extend({},m,k);if(m!==false){new c(i,j)}}});e.AutoFill=c;e.AutoFill=c;return c}));